#!/bin/bash

# The name of the file to be created.
OUTPUT_FILE="prompt.txt"

# Print directory strucutre
echo "--- DIRECTORY STRUCTURE ---" > "$OUTPUT_FILE"
echo -e "" >> "$OUTPUT_FILE"
tree . >> "$OUTPUT_FILE"
echo -e "" >> "$OUTPUT_FILE"

# Find all files, excluding specified paths and the output file itself.
find . \( -path './.git' -o -path './node_modules' -o -path './venv' \) -prune -o -type f ! -name "$OUTPUT_FILE" ! -name "$(basename "$0")" -print0 |

# Read each file path found by `find`.
# `while IFS= read -r -d ''` is the standard, safe way to read null-separated input.
while IFS= read -r -d '' file; do
  echo "--- FILE $file STARTS HERE ---" >> "$OUTPUT_FILE"
  echo "" >> "$OUTPUT_FILE"
  cat "$file" >> "$OUTPUT_FILE"
  echo "" >> "$OUTPUT_FILE"
  echo "--- FILE $file ENDS HERE ---" >> "$OUTPUT_FILE"
  echo "" >> "$OUTPUT_FILE"
done
