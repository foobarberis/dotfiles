#!/bin/sh

set -e

if [ -z "$1" ] || [ ! -f "$1" ]; then
    echo "Usage: $0 <journal_file>" >&2
    exit 1
fi

JOURNAL_FILE="$1"

# Get a list of all sectors in the order they appear in the file
NEW_TOC=$(grep '^\+ SEC/' "$JOURNAL_FILE" | sed -e 's/^\+ /~ /' -e 's/ \+$//')

# Write the new ToC and the original body to the temporary file.
echo "$NEW_TOC"
